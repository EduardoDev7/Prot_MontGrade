<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DirGrade - Sua Grade de Direito</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #f0f2f5;
            --surface-color: #ffffff;
            --text-color-primary: #2c3e50;
            --text-color-secondary: #7f8c8d;
            --header-color: #2980b9;
            --completed-bg: #2ecc71;
            --available-bg: #3498db;
            --blocked-bg: #e74c3c;
            --text-on-color: #ffffff;
            --shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            --border-radius: 10px;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color-primary);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .container {
            max-width: 95%;
            margin: auto;
            padding: 0 15px;
            width: 100%;
            flex-grow: 1;
        }
        
        .header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            padding: 10px 0;
            position: relative;
        }

        .header img {
            height: 45px;
        }

        .header h1 {
            font-size: 3.0em;
            font-weight: 700;
            color: black;
            margin: 0;
        }
        
        .btn-montar-grade {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            padding: 12px 24px;
            font-size: 1em;
            font-weight: 600;
            color: #fff;
            background-color: var(--header-color);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: background-color 0.3s, box-shadow 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.15);
        }
        .btn-montar-grade:hover {
            background-color: #3498db;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }


        .progresso-container {
            margin: 25px auto;
            max-width: 800px;
            text-align: center;
            background-color: var(--surface-color);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }
        #progresso-texto {
            display: block;
            margin-bottom: 12px;
            font-weight: 600;
            color: var(--text-color-primary);
            font-size: 1.1em;
        }
        .barra-progresso-externa {
            height: 12px;
            width: 100%;
            background-color: #e0e6ed;
            border-radius: 6px;
            overflow: hidden;
        }
        #barra-progresso-interna {
            height: 100%;
            width: 0%;
            background: linear-gradient(to right, #28a745, #1abc9c);
            border-radius: 6px;
            transition: width 0.6s ease-in-out;
        }
        
        .grade-container {
            display: flex;
            gap: 20px;
            overflow-x: auto;
            padding: 10px 5px 20px 5px; 
        }
        .grade-container::-webkit-scrollbar { height: 8px; }
        .grade-container::-webkit-scrollbar-track { background: #e0e6ed; border-radius: 4px; }
        .grade-container::-webkit-scrollbar-thumb { background-color: #aebfd0; border-radius: 4px; }
        .grade-container::-webkit-scrollbar-thumb:hover { background-color: #8fa1b8; }
        
        .periodo-coluna {
            flex: 0 0 220px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            background-color: var(--surface-color);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .periodo-coluna h2 {
            text-align: center;
            margin: 0 0 15px 0;
            padding-bottom: 15px;
            font-size: 1.2em;
            font-weight: 600;
            color: var(--header-color);
            border-bottom: 1px solid #e0e6ed;
        }

        .disciplinas-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .disciplina {
            padding: 15px;
            border-radius: var(--border-radius);
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.3s;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 120px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        .disciplina:hover { transform: translateY(-5px); box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15); }
        .disciplina.bloqueada { cursor: not-allowed; }
        .disciplina.bloqueada:hover { transform: none; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); }

        .disciplina .codigo { font-weight: 600; font-size: 0.85em; margin-bottom: 5px; opacity: 0.9; }
        .disciplina .nome { font-size: 0.95em; font-weight: 500; flex-grow: 1; display: flex; align-items: center; justify-content: center; margin: 8px 0; line-height: 1.3; }
        .disciplina .horas { font-size: 0.8em; padding: 5px 12px; border-radius: 15px; align-self: center; margin-top: 10px; font-weight: 600; }
        
        .disciplina.concluida { background-color: var(--completed-bg); color: var(--text-on-color); }
        .disciplina.concluida .codigo, .disciplina.concluida .nome, .disciplina.concluida .horas { color: var(--text-on-color); }
        .disciplina.concluida .horas { background-color: rgba(0, 0, 0, 0.2); }

        .disciplina.disponivel { background-color: var(--available-bg); color: var(--text-on-color); }
        .disciplina.disponivel .codigo, .disciplina.disponivel .nome, .disciplina.disponivel .horas { color: var(--text-on-color); }
        .disciplina.disponivel .horas { background-color: rgba(0, 0, 0, 0.2); }

        .disciplina.bloqueada { background-color: var(--blocked-bg); color: var(--text-on-color); }
        .disciplina.bloqueada .codigo, .disciplina.bloqueada .nome, .disciplina.bloqueada .horas { color: var(--text-on-color); }
        .disciplina.bloqueada .horas { background-color: rgba(0, 0, 0, 0.2); }

        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(44, 62, 80, 0.7); backdrop-filter: blur(4px);
            display: none; align-items: center; justify-content: center; z-index: 1000;
        }
        .modal-content {
            background-color: var(--surface-color); padding: 30px; border-radius: var(--border-radius);
            box-shadow: var(--shadow); max-width: 450px; width: 90%; position: relative;
            border-top: 5px solid var(--header-color); animation: fadeIn 0.3s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .modal-close-btn {
            position: absolute; top: 15px; right: 20px; background: none; border: none; font-size: 2.2em;
            color: var(--text-color-secondary); cursor: pointer; line-height: 1; transition: color 0.2s;
        }
        .modal-close-btn:hover { color: var(--header-color); }
        .modal-content h3 {
            color: var(--header-color); margin: 0 0 20px 0; font-size: 1.5em; font-weight: 700; text-align: center;
        }
        #lista-impedimentos { list-style: none; padding: 0; margin: 0; }
        #lista-impedimentos li {
            background-color: var(--bg-color); padding: 12px 15px; border-radius: 6px; margin-bottom: 10px;
            color: var(--text-color-primary); font-weight: 500; box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        #lista-impedimentos li:last-child { margin-bottom: 0; }

        .footer {
            margin-top: 40px; padding: 20px; background-color: var(--surface-color); text-align: center;
            color: var(--text-color-secondary); font-size: 0.9em; box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
            border-top: 1px solid #e0e6ed;
        }
        .footer span { color: #e74c3c; }

        @media (max-width: 800px) {
            body { padding: 10px; }

            .header { flex-direction: column; gap: 20px; }
            .header h1 { font-size: 1.8em; }
            .header img { height: 35px; }
            .btn-montar-grade { position: static; transform: none; margin-top: 10px; }
            
            #progresso-texto { font-size: 1em; }
            .progresso-container { padding: 15px; }
            
            .grade-container {
                flex-direction: column;
                overflow-x: hidden;
                gap: 25px;
            }
            .periodo-coluna { flex: 1 1 auto; }
            
            .disciplinas-grid {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 10px;
            }
            
            .disciplina { min-height: 140px; padding: 10px; }
            .disciplina .nome { font-size: 0.85em; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <img src="./-2.jpg" alt="Balança da Justiça">
            <h1>DirGrade</h1>
            <button class="btn-montar-grade" id="btn-ir-para-montagem">
                Montar Minha Grade
            </button>
        </div>
        <div class="progresso-container">
            <span id="progresso-texto">0 / 0 horas concluídas (0.0%)</span>
            <div class="barra-progresso-externa">
                <div id="barra-progresso-interna"></div>
            </div>
        </div>
        <div class="grade-container">
            <div class="periodo-coluna">
                <h2>1º Período</h2>
                <div class="disciplinas-grid">
                    <div class="disciplina" data-codigo="CSO113" data-requisitos='[]' data-horas="30"><span class="codigo">CSO113</span><p class="nome">Introdução à Sociologia</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="DIR101" data-requisitos='[]' data-horas="60"><span class="codigo">DIR101</span><p class="nome">Introdução ao Estudo do Direito I</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR103" data-requisitos='[]' data-horas="60"><span class="codigo">DIR103</span><p class="nome">Ciência Política</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR111" data-requisitos='[]' data-horas="60"><span class="codigo">DIR111</span><p class="nome">Direito Civil - Parte Geral I</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR135" data-requisitos='[]' data-horas="30"><span class="codigo">DIR135</span><p class="nome">História no Direito</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="FIL110" data-requisitos='[]' data-horas="60"><span class="codigo">FIL110</span><p class="nome">Filosofia Geral</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="PRO120" data-requisitos='[]' data-horas="30"><span class="codigo">PRO120</span><p class="nome">Economia</p><span class="horas">30h</span></div>
                </div>
            </div>
            <div class="periodo-coluna">
                <h2>2º Período</h2>
                <div class="disciplinas-grid">
                    <div class="disciplina" data-codigo="DIR012" data-requisitos='["DIR101", "DIR111"]' data-horas="60"><span class="codigo">DIR012</span><p class="nome">Direito Civil - Parte Geral II</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR102" data-requisitos='["DIR101"]' data-horas="60"><span class="codigo">DIR102</span><p class="nome">Introdução ao Estudo do Direito II</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR104" data-requisitos='["FIL110"]' data-horas="30"><span class="codigo">DIR104</span><p class="nome">Filosofia do Direito</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="DIR105" data-requisitos='["CSO113"]' data-horas="30"><span class="codigo">DIR105</span><p class="nome">Sociologia Jurídica</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="DIR121" data-requisitos='["DIR101", "DIR103"]' data-horas="60"><span class="codigo">DIR121</span><p class="nome">Teoria da Constituição</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR123" data-requisitos='[]' data-horas="30"><span class="codigo">DIR123</span><p class="nome">Direitos Humanos</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="DIR124" data-requisitos='[]' data-horas="30"><span class="codigo">DIR124</span><p class="nome">Metodologia da Pesquisa</p><span class="horas">30h</span></div>
                </div>
            </div>
            <div class="periodo-coluna">
                <h2>3º Período</h2>
                <div class="disciplinas-grid">
                    <div class="disciplina" data-codigo="DIR004" data-requisitos='["DIR102"]' data-horas="60"><span class="codigo">DIR004</span><p class="nome">Teoria Geral do Processo</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR005" data-requisitos='["DIR102"]' data-horas="30"><span class="codigo">DIR005</span><p class="nome">Ética Profissional e OAB</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="DIR006" data-requisitos='["DIR012"]' data-horas="30"><span class="codigo">DIR006</span><p class="nome">Direito do Consumidor</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="DIR031" data-requisitos='["DIR102"]' data-horas="60"><span class="codigo">DIR031</span><p class="nome">Direito Penal I</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR106" data-requisitos='[]' data-horas="30"><span class="codigo">DIR106</span><p class="nome">Mediação e Formas Consensuais</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="DIR113" data-requisitos='["DIR012"]' data-horas="60"><span class="codigo">DIR113</span><p class="nome">Direito Civil - Obrigações I</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR122" data-requisitos='["DIR121"]' data-horas="60"><span class="codigo">DIR122</span><p class="nome">Direito Constitucional I</p><span class="horas">60h</span></div>
                </div>
            </div>
            <div class="periodo-coluna">
                <h2>4º Período</h2>
                <div class="disciplinas-grid">
                    <div class="disciplina" data-codigo="DIR014" data-requisitos='["DIR113"]' data-horas="60"><span class="codigo">DIR014</span><p class="nome">Direito Civil - Obrigações II</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR023" data-requisitos='["DIR122"]' data-horas="60"><span class="codigo">DIR023</span><p class="nome">Direito Constitucional II</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR032" data-requisitos='["DIR031"]' data-horas="60"><span class="codigo">DIR032</span><p class="nome">Direito Penal II</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR107" data-requisitos='["DIR012"]' data-horas="60"><span class="codigo">DIR107</span><p class="nome">Direito Empresarial I</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR256" data-requisitos='["DIR004"]' data-horas="60"><span class="codigo">DIR256</span><p class="nome">Processual Civil I</p><span class="horas">60h</span></div>
                </div>
            </div>
            <div class="periodo-coluna">
                <h2>5º Período</h2>
                <div class="disciplinas-grid">
                    <div class="disciplina" data-codigo="DIR033" data-requisitos='["DIR032"]' data-horas="60"><span class="codigo">DIR033</span><p class="nome">Direito Penal III</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR108" data-requisitos='["DIR107"]' data-horas="60"><span class="codigo">DIR108</span><p class="nome">Direito Empresarial II</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR115" data-requisitos='["DIR113"]' data-horas="60"><span class="codigo">DIR115</span><p class="nome">Direito Civil - Contratos I</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR127" data-requisitos='["DIR023"]' data-horas="60"><span class="codigo">DIR127</span><p class="nome">Direito Administrativo I</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR257" data-requisitos='["DIR256"]' data-horas="60"><span class="codigo">DIR257</span><p class="nome">Processual Civil II</p><span class="horas">60h</span></div>
                </div>
            </div>
            <div class="periodo-coluna">
                <h2>6º Período</h2>
                <div class="disciplinas-grid">
                    <div class="disciplina" data-codigo="DIR034" data-requisitos='["DIR033"]' data-horas="60"><span class="codigo">DIR034</span><p class="nome">Direito Penal IV</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR116" data-requisitos='["DIR108"]' data-horas="60"><span class="codigo">DIR116</span><p class="nome">Direito Empresarial III</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR117" data-requisitos='["DIR115"]' data-horas="60"><span class="codigo">DIR117</span><p class="nome">Direito Civil - Posse e Propriedade</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR118" data-requisitos='["DIR115"]' data-horas="30"><span class="codigo">DIR118</span><p class="nome">Direito Civil - Contratos II</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="DIR128" data-requisitos='["DIR127"]' data-horas="60"><span class="codigo">DIR128</span><p class="nome">Direito Administrativo II</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR258" data-requisitos='["DIR257"]' data-horas="60"><span class="codigo">DIR258</span><p class="nome">Processual Civil III</p><span class="horas">60h</span></div>
                </div>
            </div>
            <div class="periodo-coluna">
                <h2>7º Período</h2>
                <div class="disciplinas-grid">
                    <div class="disciplina" data-codigo="DIR119" data-requisitos='["DIR117"]' data-horas="30"><span class="codigo">DIR119</span><p class="nome">Direitos Reais Limitados</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="DIR129" data-requisitos='["DIR128"]' data-horas="60"><span class="codigo">DIR129</span><p class="nome">Direito Administrativo III</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR130" data-requisitos='["DIR116"]' data-horas="60"><span class="codigo">DIR130</span><p class="nome">Empresarial IV - Falência</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR136" data-requisitos='["DIR012", "DIR116", "DIR256"]' data-horas="30"><span class="codigo">DIR136</span><p class="nome">Prática Simulada I - Civil</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="DIR165" data-requisitos='["DIR004", "DIR032"]' data-horas="60"><span class="codigo">DIR165</span><p class="nome">Processual Penal I</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR174" data-requisitos='["DIR115", "DIR122"]' data-horas="60"><span class="codigo">DIR174</span><p class="nome">Direito do Trabalho I</p><span class="horas">60h</span></div>
                </div>
            </div>
            <div class="periodo-coluna">
                <h2>8º Período</h2>
                <div class="disciplinas-grid">
                    <div class="disciplina" data-codigo="DIR137" data-requisitos='["DIR117"]' data-horas="60"><span class="codigo">DIR137</span><p class="nome">Direito Civil - Famílias</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR140" data-requisitos='["DIR136"]' data-horas="30"><span class="codigo">DIR140</span><p class="nome">Estágio Interno (NPJ) I</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="DIR166" data-requisitos='["DIR165"]' data-horas="60"><span class="codigo">DIR166</span><p class="nome">Processual Penal II</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR175" data-requisitos='["DIR174"]' data-horas="60"><span class="codigo">DIR175</span><p class="nome">Direito do Trabalho II</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR538" data-requisitos='["DIR023", "DIR115"]' data-horas="60"><span class="codigo">DIR538</span><p class="nome">Direito Internacional Público</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR109" data-requisitos='["DIR032", "DIR108", "DIR115", "DIR124", "DIR128", "DIR257"]' data-horas="30"><span class="codigo">DIR109</span><p class="nome">Projeto de TCC</p><span class="horas">30h</span></div>
                </div>
            </div>
            <div class="periodo-coluna">
                <h2>9º Período</h2>
                <div class="disciplinas-grid">
                    <div class="disciplina" data-codigo="DIR020" data-requisitos='["DIR129"]' data-horas="60"><span class="codigo">DIR020</span><p class="nome">Direito Tributário I</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR141" data-requisitos='["DIR137", "DIR257"]' data-horas="60"><span class="codigo">DIR141</span><p class="nome">Direito Civil - Sucessões</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR142" data-requisitos='["DIR128"]' data-horas="30"><span class="codigo">DIR142</span><p class="nome">Direito Ambiental</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="DIR143" data-requisitos='["DIR128"]' data-horas="30"><span class="codigo">DIR143</span><p class="nome">Direito do Patrimônio Cultural</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="DIR144" data-requisitos='["DIR140"]' data-horas="30"><span class="codigo">DIR144</span><p class="nome">Estágio Interno (NPJ) II</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="DIR153" data-requisitos='["DIR175"]' data-horas="60"><span class="codigo">DIR153</span><p class="nome">Processual do Trabalho</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR167" data-requisitos='["DIR166"]' data-horas="60"><span class="codigo">DIR167</span><p class="nome">Processual Penal III</p><span class="horas">60h</span></div>
                </div>
            </div>
            <div class="periodo-coluna">
                <h2>10º Período</h2>
                <div class="disciplinas-grid">
                    <div class="disciplina" data-codigo="DIR139" data-requisitos='["DIR020"]' data-horas="30"><span class="codigo">DIR139</span><p class="nome">Direito Tributário II</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="DIR145" data-requisitos='["DIR118"]' data-horas="30"><span class="codigo">DIR145</span><p class="nome">Direito Digital</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="DIR154" data-requisitos='["DIR023", "DIR141", "DIR175"]' data-horas="60"><span class="codigo">DIR154</span><p class="nome">Direito Previdenciário</p><span class="horas">60h</span></div>
                    <div class="disciplina" data-codigo="DIR172" data-requisitos='["DIR023", "DIR115"]' data-horas="30"><span class="codigo">DIR172</span><p class="nome">Direito Internacional Privado</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="DIR185" data-requisitos='["DIR109"]' data-horas="30"><span class="codigo">DIR185</span><p class="nome">Defesa de TCC</p><span class="horas">30h</span></div>
                </div>
            </div>
            <div class="periodo-coluna">
                <h2>Eletivas e Optativas</h2>
                <div class="disciplinas-grid">
                    <div class="disciplina" data-codigo="ELETIVA01" data-requisitos='[]' data-horas="30"><span class="codigo">ELETIVA</span><p class="nome">Eletiva 1</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="ELETIVA02" data-requisitos='[]' data-horas="30"><span class="codigo">ELETIVA</span><p class="nome">Eletiva 2</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="ELETIVA03" data-requisitos='[]' data-horas="30"><span class="codigo">ELETIVA</span><p class="nome">Eletiva 3</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="ELETIVA04" data-requisitos='[]' data-horas="30"><span class="codigo">ELETIVA</span><p class="nome">Eletiva 4</p><span class="horas">30h</span></div>
                    <div class="disciplina" data-codigo="OPTATIVA01" data-requisitos='[]' data-horas="30"><span class="codigo">OPTATIVA</span><p class="nome">Optativa 1</p><span class="horas">30h</span></div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="modal-impedimentos" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close-btn">&times;</button>
            <h3>Pré-requisitos Pendentes</h3>
            <ul id="lista-impedimentos"></ul>
        </div>
    </div>

    <footer class="footer">
        Desenvolvido por Eduardo Marques com <span>❤️</span> para Amanda e toda Graduação de Direito da UFOP
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const disciplinas = document.querySelectorAll('.disciplina');
            const disciplinasMap = new Map();
            const progressoBarra = document.getElementById('barra-progresso-interna');
            const progressoTexto = document.getElementById('progresso-texto');
            const modal = document.getElementById('modal-impedimentos');
            const modalList = document.getElementById('lista-impedimentos');
            const closeModalBtn = document.querySelector('.modal-close-btn');
            const btnIrParaMontagem = document.getElementById('btn-ir-para-montagem');

            let totalHorasCurso = 0;

            disciplinas.forEach(disciplina => {
                const codigo = disciplina.dataset.codigo;
                const horas = parseInt(disciplina.dataset.horas, 10);
                const nome = disciplina.querySelector('.nome').textContent;
                totalHorasCurso += horas;

                disciplinasMap.set(codigo, {
                    element: disciplina,
                    nome: nome,
                    requisitos: JSON.parse(disciplina.dataset.requisitos),
                    horas: horas,
                    status: 'bloqueada'
                });
            });

            function verificarRequisitos(disciplinaInfo) {
                if (disciplinaInfo.requisitos.length === 0) return true;
                return disciplinaInfo.requisitos.every(reqCodigo => {
                    const reqInfo = disciplinasMap.get(reqCodigo);
                    return reqInfo && reqInfo.status === 'concluida';
                });
            }

            function atualizarProgresso() {
                let horasConcluidas = 0;
                disciplinasMap.forEach(info => {
                    if (info.status === 'concluida') {
                        horasConcluidas += info.horas;
                    }
                });

                const percentual = totalHorasCurso > 0 ? (horasConcluidas / totalHorasCurso) * 100 : 0;
                progressoBarra.style.width = `${percentual}%`;
                progressoTexto.textContent = `${horasConcluidas} / ${totalHorasCurso} horas concluídas (${percentual.toFixed(1)}%)`;
            }

            function atualizarGrade() {
                disciplinasMap.forEach(disciplinaInfo => {
                    if (disciplinaInfo.status === 'concluida') {
                         disciplinaInfo.element.classList.add('concluida');
                         disciplinaInfo.element.classList.remove('bloqueada', 'disponivel');
                         return;
                    }
                    
                    const temRequisitos = verificarRequisitos(disciplinaInfo);
                    disciplinaInfo.status = temRequisitos ? 'disponivel' : 'bloqueada';
                    
                    disciplinaInfo.element.classList.remove('bloqueada', 'disponivel', 'concluida');
                    disciplinaInfo.element.classList.add(disciplinaInfo.status);
                });
            }
            
            function mostrarImpedimentos(disciplinaInfo) {
                modalList.innerHTML = ''; 
                const impedimentos = disciplinaInfo.requisitos.filter(reqCodigo => {
                    const reqInfo = disciplinasMap.get(reqCodigo);
                    return reqInfo && reqInfo.status !== 'concluida';
                });

                if (impedimentos.length === 0) {
                    modalList.innerHTML = '<li>Nenhum pré-requisito pendente.</li>';
                } else {
                    impedimentos.forEach(reqCodigo => {
                        const reqInfo = disciplinasMap.get(reqCodigo);
                        const li = document.createElement('li');
                        li.textContent = `${reqInfo.nome} (${reqInfo.element.dataset.codigo})`;
                        modalList.appendChild(li);
                    });
                }
                modal.style.display = 'flex';
            }

            function handleDisciplinaClick(e) {
                const disciplinaElement = e.currentTarget;
                const codigo = disciplinaElement.dataset.codigo;
                const disciplinaInfo = disciplinasMap.get(codigo);

                if (disciplinaInfo.status === 'bloqueada') {
                    mostrarImpedimentos(disciplinaInfo);
                    return;
                }

                if (disciplinaInfo.status === 'disponivel') {
                    disciplinaInfo.status = 'concluida';
                } else if (disciplinaInfo.status === 'concluida') {
                    let podeDesmarcar = true;
                    disciplinasMap.forEach(info => {
                        if (info.status === 'concluida' && info.requisitos.includes(codigo)) {
                            podeDesmarcar = false;
                        }
                    });

                    if (podeDesmarcar) {
                        disciplinaInfo.status = 'disponivel';
                    } else {
                        alert('Esta disciplina é pré-requisito de outras já concluídas. Desmarque-as primeiro.');
                        return;
                    }
                }
                
                atualizarGrade();
                atualizarProgresso();
            }

            btnIrParaMontagem.addEventListener('click', () => {
                const statusDasDisciplinas = {};
                for (const [codigo, info] of disciplinasMap.entries()) {
                    statusDasDisciplinas[codigo] = info.status;
                }
                sessionStorage.setItem('gradeStatus', JSON.stringify(statusDasDisciplinas));
                window.location.href = 'montar-grade.html';
            });

            disciplinas.forEach(disciplina => {
                disciplina.addEventListener('click', handleDisciplinaClick);
            });
            
            closeModalBtn.addEventListener('click', () => modal.style.display = 'none');
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                }
            });
            
            atualizarGrade();
            atualizarProgresso();
        });
    </script>
</body>
</html>